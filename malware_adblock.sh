#!/bin/sh
cd `dirname $0`
LOGMSG=DNS_UPDATE_PROC_IS_DONE
RESPONSE_IPv4=$1
RESPONSE_IPv6=$2
DIRECTORY=`pwd`
#hostnamelist
rm -rf $DIRECTORY/hostnames_raw.txt
wget -O $DIRECTORY/hostnames_raw.txt https://raw.githubusercontent.com/notracking/hosts-blocklists/master/hostnames.txt


#domainslist
rm -rf $DIRECTORY/domains_raw.txt
wget  https://raw.githubusercontent.com/notracking/hosts-blocklists/master/domains.txt -P $DIRECTORY



#Warui_Internet
rm -rf $DIRECTORY/warui_host.txt
wget -O $DIRECTORY/warui_host.txt https://warui.intaa.net/adhosts/hosts.txt

#urlhaus
wget -O $DIRECTORY/urlhaus.txt https://urlhaus.abuse.ch/downloads/hostfile/
sed -i 's/\r//g' urlhaus.txt
sed -i -z 's/\r\n/\n/g' urlhaus.txt
sed -i 's/\t/ /g' urlhaus.txt
#https://winhelp2002.mvps.org/hosts.txt
wget -O $DIRECTORY/winhelp2002.txt https://winhelp2002.mvps.org/hosts.txt

cat $DIRECTORY/winhelp2002.txt >> $DIRECTORY/hostnames_raw.txt && \
cat $DIRECTORY/warui_host.txt >> $DIRECTORY/hostnames_raw.txt && \
cat $DIRECTORY/urlhaus.txt >> $DIRECTORY/hostnames_raw.txt && \
cat $DIRECTORY/static/static_domains_raw.txt >> $DIRECTORY/domains_raw.txt && \
cat $DIRECTORY/static/static_hosts.txt >> $DIRECTORY/hostnames_raw.txt && \
# sed -i  "s/127\.0\.0\.1 /$RESPONSE_IPv4 /g" $DIRECTORY/hostnames_raw.txt  && \
# sed -i  "s/0\.0\.0\.0 /$RESPONSE_IPv4 /g" $DIRECTORY/hostnames_raw.txt && \
sed -i  "s/:: /$RESPONSE_IPv6 /g" $DIRECTORY/hostnames_raw.txt && \
sed -i  "s/127\.0\.0\.1//g" $DIRECTORY/domains_raw.txt && \
sed -i  "s/0\.0\.0\.0//g" $DIRECTORY/domains_raw.txt && \
sed "/#/d" hostnames_raw.txt
sed "/#/d" domains_raw.txt
sed -i "s/127.0.0.1/$RESPONSE_IPv4/g" hostnames_raw.txt
sed -i "s/0.0.0.0/$RESPONSE_IPv4/g" hostnames_raw.txt
uniq -u hostnames_raw.txt > hostnames.txt
uniq -u domains_raw.txt > domains.txt