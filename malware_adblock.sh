#!/bin/sh
cd `dirname $0`
LOGMSG=DNS_UPDATE_PROC_IS_DONE
RESPONSE_IPv4=$1
RESPONSE_IPv6=$2
DIRECTORY=`pwd`
#hostnamelist
rm -rf $DIRECTORY/hostnames_raw.txt
wget -O $DIRECTORY/hostnames_raw.txt https://raw.githubusercontent.com/notracking/hosts-blocklists/master/hostnames.txt


#domainslist
rm -rf $DIRECTORY/domains_raw.txt
wget  -O $DIRECTORY/domains_raw.txt https://raw.githubusercontent.com/notracking/hosts-blocklists/master/domains.txt



#Warui_Internet
rm -rf $DIRECTORY/warui_host.txt
wget -O $DIRECTORY/warui_host.txt https://warui.intaa.net/adhosts/hosts.txt

#urlhaus
wget -O $DIRECTORY/urlhaus.txt https://urlhaus.abuse.ch/downloads/hostfile/

#https://winhelp2002.mvps.org/hosts.txt
wget -O $DIRECTORY/winhelp2002.txt https://winhelp2002.mvps.org/hosts.txt

cat $DIRECTORY/winhelp2002.txt >> $DIRECTORY/hostnames_raw.txt
cat $DIRECTORY/warui_host.txt >> $DIRECTORY/hostnames_raw.txt
cat $DIRECTORY/urlhaus.txt >> $DIRECTORY/hostnames_raw.txt
sed -i 's/\r//g' hostnames_raw.txt
sed -i 's/\r\n/\n/g' hostnames_raw.txt
sed -i 's/\t/ /g' hostnames_raw.txt
sed -i  "s/:: /$RESPONSE_IPv6 /g" $DIRECTORY/hostnames_raw.txt 
sed -i  "s/127\.0\.0\.1//g" $DIRECTORY/domains_raw.txt 
sed -i  "s/0\.0\.0\.0//g" $DIRECTORY/domains_raw.txt
sed -i "s/127.0.0.1/$RESPONSE_IPv4/g" hostnames_raw.txt
sed -i "s/0.0.0.0/$RESPONSE_IPv4/g" hostnames_raw.txt
sort hostnames_raw.txt |uniq | sed -e '/^\/\//d' -e '/^\#/d' > hostnames.txt
sort domains_raw.txt|uniq | sed -e '/^\/\//d' -e '/^\#/d' > domains.txt
echo >> $DIRECTORY/domains.txt
echo >> $DIRECTORY/hostnames.txt
cat $DIRECTORY/static/static_domains.txt >> $DIRECTORY/domains.txt
cat $DIRECTORY/static/static_hosts.txt >> $DIRECTORY/hostnames.txt